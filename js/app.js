define("controllers/historyController",["exports","app","controllers/dataController","controllers/uiController","controllers/paintController"],function(e,t,n,r,i){function a(){f(),l(),c()}function f(){}function l(){}function c(){e.index=o.length,h()}function h(){o.splice(0,e.index),u=u-e.index+1,u=u<0?u+e.MAX_UNDO_HISTORY:u>=e.MAX_UNDO_HISTORY?u-e.MAX_UNDO_HISTORY:u,e.index=0,o.unshift(u),o.splice(e.MAX_UNDO_HISTORY,1),i.saveHistory(u),n.saveHistory(u),r.setUndoAvailability(o.length>1),r.setRedoAvailability(!1)}function p(){if(o.length>0&&e.index<o.length-1){t.playMode&&n.endRedraw(),e.index++;var s=o[e.index];i.loadHistory(s),n.loadHistory(s),r.setUndoAvailability(e.index<o.length-1),r.setRedoAvailability(!0)}}function d(){if(e.index>0){t.playMode&&n.endRedraw(),e.index--;var s=o[e.index];i.loadHistory(s),n.loadHistory(s),r.setUndoAvailability(!0),r.setRedoAvailability(e.index>0)}}var s;e.history=[],e.index=0,e.MAX_UNDO_HISTORY=8;var o=e.history,u=-1;e.init=a,e.reset=c,e.save=h,e.undo=p,e.redo=d}),define("controllers/socialController",["exports","app","controllers/dataController","controllers/uiController","controllers/paintController"],function(e,t,n,r,i){function m(){g(),y(),window.onGoogleApiReady?window.__isGoogleApiReady?(window.onGoogleApiReady=E,E()):window.onGoogleApiReady=E:w()}function g(){_socialContainer=document.getElementById("share-container"),a=document.getElementById("long-url"),f=document.getElementById("short-url"),l=_socialContainer.querySelector(".facebook"),c=_socialContainer.querySelector(".twitter"),h=_socialContainer.querySelector(".close-btn")}function y(){_socialContainer.addEventListener("click",b)}function b(e){(e.target==_socialContainer||e.target==h)&&N("show")}function w(){window.onGoogleApiReady=E;var e=document.createElement("script");e.type="text/javascript",e.src="https://apis.google.com/js/client.js?onload=onGoogleApiReady";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}function E(){gapi.client.setApiKey(o),gapi.client.load("urlshortener","v1",S)}function S(){v=!0,d&&x()}function x(){if(!v)return;var t=e.SHARE_URL_BASE+n.compressData(n.data),r=gapi.client.urlshortener.url.insert({resource:{longUrl:t}});r.execute(function(e){if(p!=e.longUrl)return;e.error?(f.classList.add("error"),f.value="Something is wrong and the url can't be shortened"):(_socialContainer.classList.add("ready"),f.classList.remove("error"),f.value=e.id,l.setAttribute("href","https://www.facebook.com/sharer.php?u="+encodeURIComponent(e.id)+"&t=Check out my artwork"),c.setAttribute("href","https://twitter.com/intent/tweet?text="+encodeURIComponent("Check out my artwork: ")+encodeURIComponent(e.id)))})}function T(){var t=n.compressData(n.data);p=e.SHARE_URL_BASE+t,a.value=e.HASHED_SHARE_URL_BASE+t,d=!0,l.removeAttribute("href"),c.removeAttribute("href"),_socialContainer.classList.remove("ready"),_socialContainer.classList.add("show"),t.length<e.MAXIMUM_DATA_LENGTH?(f.value="Requesting Shortened URL from Google API...",x(p)):f.value="URL is too long as what she says that can't be shared via social network."}function N(){d=!1,_socialContainer.classList.remove("show")}var s;e.SHARE_URL_BASE=window.__DEFAULT_SHARE_URL+"?data=",e.HASHED_SHARE_URL_BASE=window.__DEFAULT_SHARE_URL+"#",e.SHARE_URL_BASE_LENGTH=e.SHARE_URL_BASE.length,e.MAXIMUM_DATA_LENGTH=2048-e.SHARE_URL_BASE_LENGTH;var o="AIzaSyAkV0WiUgBsOGcP8VS1AhSULMfwnndiMh0",u,a,f,l,c,h,p="",d=!1,v=!1;e.init=m,e.onFooterIconsClick=T}),define("controllers/paintController",["exports","app","controllers/dataController","controllers/uiController","controllers/historyController","controllers/socialController"],function(e,t,n,r,i,s){function T(){N(),C()}function N(){var t,n;u=e.canvas=document.getElementById("canvas"),a=u.getContext("2d"),f=document.createElement("canvas"),l=f.getContext("2d");for(t=0;t<x;t++)p[t]=new Ribbon(0,0);for(t=0;t<i.MAX_UNDO_HISTORY;t++)n=c[t]=document.createElement("canvas"),h[t]=n.getContext("2d")}function C(){}function k(){l.drawImage(u,0,0),u.width=t.stageWidth,u.height=t.stageHeight,a.drawImage(f,t.halfW-t.prevHalfW,t.halfH-t.prevHalfH),Ribbon.maxDistance=Math.sqrt(t.halfW*t.halfW+t.halfH*t.halfH)*2,f.width=t.stageWidth,f.height=t.stageHeight}function L(){t.playMode&&n.endRedraw(),a.clearRect(0,0,window.innerWidth,window.innerHeight),n.data="",t.playMode=!1,i.save(),r.updateURLLength(0)}function A(){var e=r.guiData;d=e.numOfBrush;var t=e.r>>0,i=e.g>>0,s=e.b>>0,o=e.opacity;a.fillStyle="rgba("+t+","+i+","+s+","+o+")",a.strokeStyle="rgba("+t+","+i+","+s+","+o*o*o+")";var u,f,l;for(var c=0;c<d;c++)f=(d-c)/d,u=p[c],u.radiusBase=f*f*f/d*e.radiusBase,u.radiusScale=f*e.radiusScale,u.radiusPower=e.radiusPower,l=Math.cos(f*Math.PI)*e.radiusBase,u.offsetX=Math.sin(f*Math.PI*2)*l,u.offsetY=Math.cos(f*Math.PI*2)*l;n.saveLocalStorageSetting()}function O(e,t){for(var n=0;n<d;n++)p[n].reset(e,t)}function M(e,t){b=E=g=e,w=S=y=t}function _(e,t){E=e,S=t}function D(){g+=(E-g)*.2,y+=(S-y)*.2;var e=g+t.halfW>>0,r=y+t.halfH>>0,i;if(v==e&&m==r)return;v=e,m=r,t.playMode||(n.appendData(E-b+"/"+(S-w)+"/"),b=E,w=S);for(var s=0;s<d;s++)i=p[s],i.update(e+i.offsetX,r+i.offsetY),a.beginPath(),a.moveTo(i.p2_p0x,i.p2_p0y),a.quadraticCurveTo(i.p2_c0x,i.p2_c0y,i.p1_p0x,i.p1_p0y),a.lineTo(i.p1_p1x,i.p1_p1y),a.quadraticCurveTo(i.p2_c1x,i.p2_c1y,i.p2_p1x,i.p2_p1y),a.fill(),a.stroke()}function P(){var e;for(var t=0;t<d;t++)e=p[t],a.beginPath(),a.arc(e.p1_x,e.p1_y,e.p1_radius,e.previousAngle-Math.PI,e.previousAngle,!1),a.fill()}function H(e){var n=c[e];a.clearRect(0,0,t.stageWidth,t.stageHeight),a.drawImage(n,t.stageWidth-n.width>>1,t.stageHeight-n.height>>1)}function B(e){var n=c[e],r=h[e];n.width=t.stageWidth,n.height=t.stageHeight,r.clearRect(0,0,t.stageWidth,t.stageHeight),r.drawImage(u,0,0)}var o;e.canvas=null;var u,a,f,l,c=[],h=[],p=[],d=0,v=-1,m=-1,g=0,y=0,b=0,w=0,E=0,S=0,x=10;e.init=T,e.onResize=k,e.clearRect=L,e.resetRibbons=O,e.onSettingChanged=A,e.setDownXY=M,e.setMoveXY=_,e.drawLine=D,e.drawCap=P,e.loadHistory=H,e.saveHistory=B}),define("controllers/uiController",["exports","app","controllers/dataController","controllers/paintController","controllers/historyController","controllers/socialController"],function(e,t,n,r,i,s){function x(){n.loadLocalStorageSetting(),u.loadLocal=n.loadLocalStorageData,u.saveLocal=n.saveLocalStorageData,u.clearLocal=n.clearLocalStorage,u.cleanUp=r.clearRect,u.undo=i.undo,u.redo=i.redo,T(),N()}function T(){g=document.getElementById("footer"),y=g.querySelectorAll(".social-icon"),b=g.querySelector(".info"),h=document.getElementById("image-container"),p=document.getElementById("image"),c=document.getElementById("transparency-checkbox"),d=document.getElementById("code-container"),v=document.getElementById("code"),m=document.getElementById("redraw-btn"),a=new dat.GUI}function N(){h.addEventListener("click",L,!1),c.addEventListener("click",A),d.addEventListener("click",L,!1),m.addEventListener("click",k);for(var e=0;e<y.length;e++)y[e].addEventListener("click",s.onFooterIconsClick,!1);f=a.addFolder("Brush"),l=a.addFolder("File");var t;f.add(u,"numOfBrush",1,10).step(1).name("number of brush").onChange(r.onSettingChanged),f.add(u,"radiusBase",0,50).name("base radius").onChange(r.onSettingChanged),f.add(u,"radiusScale",0,80).name("radius scale").onChange(r.onSettingChanged),f.add(u,"radiusPower",1,500).name("radius power").onChange(r.onSettingChanged),w=f.addColor(u,"color").onChange(_),f.add(u,"opacity",0,1).onChange(r.onSettingChanged),l.add(u,"loadLocal").name("load local storage"),l.add(u,"saveLocal").name("save local storage"),l.add(u,"clearLocal").name("clear local storage"),l.add(u,"savePNG").name("save as PNG"),l.add(u,"viewCode").name("view codes"),a.add(u,"cleanUp").name("clean up canvas"),a.add(u,"redraw").name("redraw"),E=a.add(u,"undo").name("undo (ctrl + z)"),S=a.add(u,"redo").name("redo (ctrl + y)"),f.open(),l.open()}function C(){n.redrawData(n.compressData(n.data))}function k(){d.classList.remove("show"),n.redrawData(v.value)}function L(e){e.target.classList.contains("interactive")||this.classList.remove("show")}function A(){O(this.checked)}function O(e){var t=r.canvas;if(e)p.src=r.canvas.toDataURL("image/png");else{var n=document.createElement("canvas"),i=n.getContext("2d");n.width=t.width,n.height=t.height,i.fillStyle="#fff",i.fillRect(0,0,t.width,t.height),i.drawImage(t,0,0),p.src=n.toDataURL("image/png"),delete n,delete i}}function M(){var e=f.__controllers;for(var t in e)e[t].updateDisplay()}function _(){u.r=w.__color.r>>0,u.g=w.__color.g>>0,u.b=w.__color.b>>0,r.onSettingChanged()}function D(){h.classList.add("show"),O(!0)}function P(){d.classList.add("show"),v.value=n.compressData(n.data)}function H(){document.getElementById("logo").classList.add("show"),g.classList.add("show"),document.querySelector(".dg.ac").classList.add("show")}function B(e){b.innerHTML="<< SHARE YOUR ARTWORK ("+(e+1e4).toString().substr(1)+"/"+s.MAXIMUM_DATA_LENGTH+")",e>s.MAXIMUM_DATA_LENGTH?g.classList.add("no-share"):g.classList.remove("no-share")}function j(e){var t=E.domElement.parentNode.classList;e?E.domElement.parentNode.classList.remove("disable"):E.domElement.parentNode.classList.add("disable")}function F(e){var t=S.domElement.parentNode.classList;e?t.remove("disable"):t.add("disable")}var o;e.guiData={numOfBrush:0,radiusBase:0,radiusScale:0,radiusPower:0,color:[0,0,0],r:0,g:0,b:0,opacity:0,loadLocal:null,saveLocal:null,clearLocal:null,savePNG:D,viewCode:P,cleanUp:null,redraw:C,undo:null,redo:null};var u=e.guiData,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S;e.init=x,e.updateRGB=_,e.updateBrushSetting=M,e.updateURLLength=B,e.show=H,e.setUndoAvailability=j,e.setRedoAvailability=F}),define("controllers/dataController",["exports","app","controllers/uiController","controllers/paintController","controllers/historyController","controllers/socialController"],function(e,t,n,r,s,o){function w(){E(),S()}function E(){localStorage[a]&&(e.setting=JSON.parse(localStorage[a]));for(i=0;i<s.MAX_UNDO_HISTORY;i++)d[i]="",v[i]={}}function S(){}function x(){localStorage[f]&&T(localStorage[f])}function T(i){r.clearRect(),e.data=B(i),n.updateURLLength(P(e.data)),N(p),l=e.data.replace(/M/g,"/-").replace(/F/g,".").split("/"),t.playMode=!0}function N(e){var t=n.guiData;for(var r in t)e[r]=t[r]}function C(e){var t=n.guiData;for(var i in e)t[i]=e[i];n.updateBrushSetting(),r.onSettingChanged()}function k(){localStorage[f]=H(e.data)}function L(){var e=n.guiData;e.numOfBrush=m.numOfBrush,e.radiusBase=m.radiusBase,e.radiusScale=m.radiusScale,e.radiusPower=m.radiusPower,e.color[0]=m.r,e.color[1]=m.g,e.color[2]=m.b,e.opacity=m.opacity}function A(){var t=n.guiData;m.numOfBrush=t.numOfBrush,m.radiusBase=t.radiusBase,m.radiusScale=t.radiusScale,m.radiusPower=t.radiusPower,m.r=t.r>>0,m.g=t.g>>0,m.b=t.b>>0,m.opacity=t.opacity,localStorage[a]=JSON.stringify(m),e.settingChanged=!0}function O(){localStorage[f]="",localStorage[a]="",e.settingChanged=!0}function M(){var e;l.length>1?l[0]=="S"?(e=n.guiData,l.shift(),e.numOfBrush=parseInt(l.shift(),10),e.radiusBase=parseFloat(l.shift()),e.radiusScale=parseFloat(l.shift()),e.radiusPower=parseFloat(l.shift()),e.r=e.color[0]=l.shift(),e.g=e.color[1]=l.shift(),e.b=e.color[2]=l.shift(),e.opacity=parseFloat(l.shift()),n.updateBrushSetting(),r.onSettingChanged()):l[0]=="D"?(l.shift(),c=parseInt(l.shift(),10),h=parseInt(l.shift(),10),r.setDownXY(c,h),r.resetRibbons(c+t.halfW,h+t.halfH),r.drawLine()):(c=parseInt(l.shift(),10)+c,h=parseInt(l.shift(),10)+h,r.setMoveXY(c,h),r.drawLine(),(l.length===0||isNaN(parseInt(l[0],10)))&&r.drawCap()):(l.shift(),_(),s.save())}function _(){t.playMode=!1,C(p)}function D(t){e.data=(e.data+t).replace(/\/\-/g,"M").replace(/\./g,"F")}function P(e){var t,n,r,i=e.length;for(t=0,len=i;t<len;t++)n=e[t],(n=="M"||n=="/")&&t+1<len&&(r=e.charCodeAt(t+1))>47&&r<58&&i--;return i}function H(e){var t,n,r,i,s=[];for(t=0,n=e.length;t<n;t++)r=e[t],(r=="M"||r=="/")&&t+1<n&&(i=e.charCodeAt(t+1))>47&&i<58?(s.push(String.fromCharCode(r=="M"?i+49:i+59)),t++):s.push(r);return s.join("")}function B(e){var t,n,r,i=[];for(t=0,n=e.length;t<n;t++)(r=e.charCodeAt(t))>106?i.push("/",String.fromCharCode(r-59)):r>96?i.push("M",String.fromCharCode(r-49)):i.push(e[t]);return i.join("")}function j(){y===0?b<o.MAXIMUM_DATA_LENGTH&&b!=e.data.length&&(b=P(e.data),y=g,n.updateURLLength(b)):y--}function F(t){b=0,y=0,j(),e.data=d[t],n.updateURLLength(P(e.data))}function I(t){d[t]=e.data}var u,a="zen-painting-setting",f="zen-painting-data";e.LOCAL_STORAGE_DATA_ID=f,e.setting=localStorage[a]?JSON.parse(localStorage[a]):{numOfBrush:5,radiusBase:15,radiusScale:20,radiusPower:150,r:0,g:0,b:0,opacity:1},e.settingChanged=!1,e.data="";var l=[],c,h,p={},d=[],v=[],m=e.setting,g=30,y=g,b=0;e.init=w,e.loadLocalStorageData=x,e.saveLocalStorageData=k,e.clearLocalStorage=O,e.loadLocalStorageSetting=L,e.saveLocalStorageSetting=A,e.redrawData=T,e.endRedraw=_,e.runData=M,e.appendData=D,e.compressData=H,e.decompressData=B,e.compressTick=j,e.loadHistory=F,e.saveHistory=I}),define("app",["exports","controllers/dataController","controllers/uiController","controllers/paintController","controllers/historyController","controllers/socialController"],function(e,t,n,r,i,s){function f(){c(),h(),t.init(),n.init(),n.show(),n.updateURLLength(0),r.init(),i.init(),s.init(),l(),n.updateRGB(),y(),b()}function l(){var e=window.location.href.toString(),n=u;e.indexOf("#")>0?n=e.split("#")[1]:window.__QUERY_STRING.data&&(n=window.__QUERY_STRING.data),t.redrawData(n)}function c(){a=document.getElementById("canvas")}function h(){window.addEventListener("resize",y),window.addEventListener("orientationchange",y),"ontouchstart"in window?(a.addEventListener("touchstart",function(e){e.preventDefault(),v(d(e))}),window.addEventListener("touchmove",function(e){e.preventDefault(),m(d(e))}),window.addEventListener("touchend",function(e){g(d(e))})):(a.addEventListener("mousedown",function(e){e.preventDefault(),v(e)}),window.addEventListener("mousemove",function(e){e.preventDefault(),m(e)}),window.addEventListener("mouseup",g)),window.addEventListener("keyup",p)}function p(e){e.ctrlKey&&(e.keyCode==90?i.undo():e.keyCode==89&&i.redo())}function d(e){var t=e.touches.length>0?e.touches[0]:e.changedTouches[0];return t}function v(i){var s=i.pageX-e.halfW,o=i.pageY-e.halfH;e.isDown=!0,e.playMode&&r.clearRect(),r.setDownXY(s,o),r.resetRibbons(i.pageX,i.pageY);if(t.settingChanged){var u=n.guiData;t.appendData("S/"+u.numOfBrush+"/"+u.radiusBase+"/"+u.radiusScale+"/"+u.radiusPower+"/"+u.r+"/"+u.g+"/"+u.b+"/"+u.opacity+"/")}t.appendData("D/"+s+"/"+o+"/")}function m(t){if(!e.isDown)return;r.setMoveXY(t.pageX-e.halfW,t.pageY-e.halfH)}function g(t){if(!e.isDown)return;e.isDown=!1,r.drawCap(),i.save()}function y(){e.prevHalfW=e.halfW,e.prevHalfH=e.halfH,e.stageWidth=window.innerWidth,e.stageHeight=window.innerHeight,e.halfW=e.stageWidth>>1,e.halfH=e.stageHeight>>1,r.onResize(),r.onSettingChanged()}function b(){window.requestAnimationFrame(b);if(e.playMode){t.runData();return}t.compressTick();if(!e.isDown)return;r.drawLine()}var o;e.stageWidth=window.innerWidth,e.stageHeight=window.innerHeight,e.halfW=0,e.halfH=0,e.prevHalfW=0,e.prevHalfH=0,e.playMode=!1,e.isDown=!1;var u="Sso1F360295277772096q7F05882541036117p6F03676624962207l17t8p4kF23161765355552374/De06o21kkpjl8d7m9f1n2h5n1g5o5h8n2f5l3c8nb6kikfkdkb/Sso1F360295277772096q7F05882541036117p6F03676624962207l17t8p4kF23161765355552374/Dc37nkkkc6ch5b1h7if8b0h2kh8ef6dd0bb8kb7kked5cgcb7bhbfdjbfchbfcckebcbebc/Ssm0F404412337034238n3F52941270518058p6F03676624962207l60l42l00kF23161765355552374/Db79o70kkkepc6te8m9i8n6b12n0i5n6h5n0h7m3j8m1i2l0f5kb1kbkkkkkkkk/Spl4F338235696294326m2F05882414814512p6F03676624962207l60l42l00kF20955882940737863/Dc4l28kkkdn1c3p3d8q0e2r4e6r2d1r8d4q6c5o0b9m8b0l0gl3bl3cl5dl9b0m2b1n0b9n1c7m3c6m0c9l1b9m4e1m0d0l8c6kkl3c7l0b3/Spn6F948530448143075p5F5882368533257p6F03676624962207p2n9l0kF4080882467406847/Dg57o11kbkebb1mb1m1c1n6d3s2f3t8g8p8e1q9c5p8c3n2b3l6b0oglgkilglhoelembmdncodrf/Spm3F713235959256o4F11764829629024p6F03676624962207p2n9l0kF4080882467406847/Db12b1kkmgqb0tb9l6c7n3d9o1e2p0e9o7e0p3e0r0f1p9d8p8c9n3b7l8hshofkdcb0/Spl4F889706299997954m3F823530079996726p6F03676624962207o7n5qkF28676471392588654/Dc51f17kklsnm1kkkl7l0s1oq6pq4om0po4kp3lo3ko4mm7kl6lqklkkkkkkkkkkkkllmkkklkkkkklk/Spl4F889706299997954m3F823530079996726p6F03676624962207o7n5qkF28676471392588654/De23o04kkpel9b9m2d0m1d7td6tc5rb6pb2nhmindkblkkkkbkblkmcleoepisi/SprF169117848147163qF176470761480633p6F03676624962207o7n5qkF28676471392588654/Db53o08kkkfmb5td2l3e3m6h8m9g4m8f8m2f1m4g1l9f0rf4me5kc7cgbhkccdkd/Spl1F029412074072559l5F882353386664485p6F03676624962207l52l21o9kF11029412074072559/Dn25b19kkkb2kb6l4d3l2e0m1g1l6b23kb65c4h3c6kc4kb3kfkfk/Spo6F32353071110475q9F70588430813858p6F03676624962207l37n5n5kF5073529554073377/Dn24e01kkhpb9ne2kkkb24id7b0d2c0b3hkkrrn5m2p8m7p6l3p0rn1rl2qotlpkpkkkkkkkckckckhkjpd1oc9rc0qhpenfncmeodrfokqktotrsrl6l1pkl6nl2e/Spm8F676471392588653m6F470588977774142p6F03676624962207q5n6n6kF5073529554073377/Ssl2F132353281479816m5F588236011848338p6F03676624962207p7ttkF5073529554073377/Dm92d95kkkcdgib1b6b6d9c4i2d9f0c3/Ssl2F132353281479816m5F588236011848338p6F036766249622/Dq15b74kmkpkpospl0ntnn/",a;setTimeout(f)})